<div class="mainChats">

    <div class="leftButtons">
       
    </div>

    <div class="headerChats">
    
        <div class="headerChatsElement">

            <div class="OtherOptions">
               
                <p class="paragrafo"> My Chats</p>
               
                <button mat-icon-button [matMenuTriggerFor]="menu">
                    <mat-icon>more_horiz</mat-icon>
                  </button>
                  
                  <mat-menu #menu="matMenu">
                    <button mat-menu-item>Logout</button>
                    <button mat-menu-item>Item 2</button>
                    <button mat-menu-item>Item 3</button>
                  </mat-menu>
                  
            </div>
         

           <mat-form-field appearance="fill" class="inputSearch" (input)="search($event)">

            <mat-label>Search</mat-label>
            <input matInput type="search" placeholder="ex:John" >
        
            </mat-form-field>


        </div>
        
        <div class="Friends">
            
                <div  *ngFor="let i of users" class="userProfInfo">
                       
                       <mat-card (click) ="chatUser(i)" style="width: 100%;" class=" cardUser" *ngIf="i.status == true && i.id != userAuthenticated">
                        <mat-card-content style="display: flex; gap: 1rem;">
                            <img src="assets/Images/perfil.png" class="imgUser">
                            <p class="userName">{{i.firstname + " " + i.lastname}}</p>
                        </mat-card-content>
                      </mat-card>
                      
                </div>
              
                  
          
        </div>

    </div>

    <div class="chats">

         <div class="startingMessage" *ngIf="clicked == false"> Click on any chat on your left to start conversation! </div>

    
          
        <div class="perfilFriend" *ngIf="clicked">

          
            <mat-card style="width: 100%;" class=" profile cardUser">
                <mat-card-content style="display: flex; gap: 1rem;">
                    <img src="assets/Images/perfil.png" class="imgUser">
                    <p class="userName">{{selectedUser}}</p>
                </mat-card-content>
              </mat-card>
              
        </div> 

        
        <div class="Messages">
          <div *ngIf="clicked && userContent" style="width: 100%; display: flex; flex-direction: column; align-items: flex-start;">
            <div *ngFor="let item of userContent.content">
              <ng-container *ngIf="item.data.type === 'message'">
                <!-- Exibir mensagem -->
                <mat-card [style.background-color]="item.data.userId === userAuthenticated ? 'dodgerblue' : 'lightgray'" style="width: 100%; margin-bottom: 0.5rem; color: white;">
                  <mat-card-content>
                    <p style="font-size: 16px;">{{ item.data.content_or_FileName}}</p>
                    <small>{{ item.data.sentAt_or_UploadedAt| date:'dd/MM/yyyy HH:mm'}}</small>
                  </mat-card-content>
                </mat-card>
              </ng-container>
              <ng-container *ngIf="item.data.type === 'document'">
                <!-- Exibir documento -->
                <mat-card style="width: 100%; margin-bottom: 0.5rem; background-color: lightgray; align-self: flex-start;">
                  <mat-card-content>
                    <p style="font-size: 16px;">{{ item.data.content_or_FileName}}</p>
                    <small>{{item.data.sentAt_or_UploadedAt | date:'dd/MM/yyyy HH:mm'}}</small>
                  </mat-card-content>
                </mat-card>
              </ng-container>
            </div>
          </div>
        </div>   
        
        <div class="textArea" *ngIf="clicked">
            <form [formGroup]="messageForm" (ngSubmit)="onSubmit()" #documentForm="ngForm">
              <div>
                <input type="file" name="file" (change)="onFileSelected($event)" required>
                <input type="hidden" name="conversationId" formControlName="conversationId" value="">
                <input type="hidden" name="userId" formControlName="userId" value="1">
              </div>
              
              <div style="display: flex;">
                <mat-form-field>
                  <mat-label>Type here!</mat-label>
                  <textarea matInput placeholder="Ex. Good Morning, here's the document you were wondering about!" formControlName="userMessage"></textarea>
                </mat-form-field>
          
                <div>
                  <button type="submit">Enviar Documento</button>
                </div>
              </div>
            </form>
          </div>
          

    </div>

</div>